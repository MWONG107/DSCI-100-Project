ibrary(tidyverse)
players <- read_csv("Data/players.csv")
sessions <- read_csv("Data/sessions.csv")

#Data Tidying
sessions <- sessions |>
mutate(
    start_time = dmy_hm(start_time),
    end_time = dmy_hm(end_time),
    start_date = as.Date(start_time), 
    original_start_time_posix = as.POSIXct(original_start_time / 1000, origin = "1970-01-01", tz = "UTC"),
     original_end_time_posix  = as.POSIXct(original_end_time / 1000, origin = "1970-01-01", tz = "UTC"),
    start_clock_time = format(start_time, "%H:%M"),
    end_date = as.Date(end_time),
    end_clock_time = format(end_time, "%H:%M")
  ) |>
mutate(
    original_start_date = as.Date(original_start_time_posix),
    original_start_clock_time = format(original_start_time_posix, "%H:%M"),
    original_end_date = as.Date(original_end_time_posix),
    original_end_clock_time = format(original_end_time_posix, "%H:%M")) |>  
select(hashedEmail, start_date, start_clock_time, end_date, end_clock_time,
         original_start_clock_time, original_end_clock_time, original_start_date, original_end_date)
sessions
# Only the sessions dataset needs actual tidying, the players one is fine. 

#Change 2, Finding the mean of the players dataset
mean_table <- players |>
  summarise(
    Mean_Played_Hours = mean(played_hours, na.rm = TRUE),
    Mean_Age = mean(Age, na.rm = TRUE)
  )

mean_table
